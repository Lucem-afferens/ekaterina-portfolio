---
rule_type: always
description: WordPress CMS integration rules and best practices for portfolio theme
---

# WordPress CMS Integration Rules

## Core Principles

- **Разделение логики и контента:** Вся динамическая информация (тексты, фотографии, отзывы, услуги, контакты, статистика) должна управляться через WordPress Admin Panel
- **Тема WordPress:** Сайт создается как кастомная WordPress тема для портфолио ведущей
- **Управление контентом:** Администратор должен иметь возможность изменять весь контент без редактирования кода
- **Стили:** Проект использует обычный CSS (файл `main.css`), а не Sass/SCSS

---

## Структура WordPress Темы

### Обязательная структура файлов:
```
ekaterina-portfolio-theme/
├── style.css (обязательный заголовок темы)
├── functions.php (инициализация темы, хуки, регистрация скриптов)
├── index.php (основной шаблон)
├── header.php (шапка сайта)
├── footer.php (подвал сайта)
├── single.php (страница отдельной записи)
├── page.php (страница)
├── archive.php (архив записей)
├── template-parts/ (переиспользуемые части шаблонов)
│   ├── content/
│   ├── components/
│   │   ├── hero-section.php
│   │   ├── introduction-section.php
│   │   ├── portfolio-section.php
│   │   ├── services-section.php
│   │   ├── testimonials-section.php
│   │   └── contact-section.php
│   └── sections/
├── assets/
│   ├── css/
│   │   └── main.css (основной файл стилей)
│   ├── js/
│   │   └── main.js (JavaScript файлы)
│   ├── images/
│   └── fonts/
└── inc/ (вспомогательные PHP файлы)
    ├── custom-post-types.php
    ├── custom-fields.php
    ├── theme-setup.php
    └── enqueue-scripts.php
```

---

## WordPress Functions & Hooks

### Обязательные практики:

1. **Регистрация стилей и скриптов:**
   - Использовать `wp_enqueue_style()` и `wp_enqueue_script()`
   - Все через `functions.php` в хуке `wp_enqueue_scripts`
   - Указывать зависимости, версии
   - Использовать `get_template_directory_uri()` для путей

2. **Безопасность:**
   - Всегда использовать функции экранирования:
     - `esc_html()`, `esc_attr()`, `esc_url()`, `esc_textarea()`
     - `wp_kses_post()` для разрешенного HTML
   - Использовать `wp_nonce_field()` для форм
   - Валидировать и санитизировать данные: `sanitize_text_field()`, `intval()`, `absint()`

3. **Поддержка WordPress функций:**
   - `add_theme_support()` для поддержки функций (thumbnails, title-tag, etc.)
   - Использовать стандартные хуки WordPress
   - Следовать WordPress Coding Standards

---

## Управление контентом через CMS

### Secure Custom Fields (SCF) - Рекомендуемый подход

1. **Для всех динамических данных использовать SCF:**
   - Тексты секций → SCF Fields (Text, WYSIWYG)
   - Фотографии портфолио → SCF Image/Gallery Fields
   - Отзывы клиентов → SCF Repeater или Custom Post Type
   - Услуги → SCF Repeater
   - Контактные данные → SCF Options Page
   - Статистика (количество мероприятий, лет опыта) → SCF Number Fields

2. **Структура SCF для основных разделов:**

   **Hero секция:**
   - Заголовок (имя ведущей)
   - Подзаголовок/описание
   - Фоновое изображение
   - Текст кнопки CTA

   **О себе (Introduction):**
   - Заголовок секции
   - Текст описания
   - Изображение
   - Дополнительные блоки текста

   **Портфолио:**
   - Галерея работ (Repeater: изображение, название, описание)
   - Категории мероприятий

   **Услуги:**
   - Список услуг (Repeater: название, описание, список пунктов)
   - Иконки или изображения услуг

   **Отзывы:**
   - Отзывы клиентов (Repeater: текст, имя, должность, компания)
   - Или Custom Post Type "testimonials"

   **Контакты:**
   - Телефон, email, адрес (Options Page)
   - Социальные сети (Repeater)
   - Время работы

3. **Кастомные типы записей (Custom Post Types):**
   - `portfolio_items` - Элементы портфолио (если нужна детальная структура)
   - `testimonials` - Отзывы (если нужна детальная структура)
   - Использовать `register_post_type()` в `functions.php`

---

## Правила кодирования для WordPress

### PHP код:

1. **Всегда использовать теги WordPress:**
   ```php
   <?php get_header(); ?>
   <?php get_footer(); ?>
   <?php get_template_part('template-parts/components/hero-section'); ?>
   ```

2. **Работа с контентом:**
   - Использовать `the_content()`, `the_title()`, `the_excerpt()`
   - Для SCF: `SCF::get()`, `SCF::get_field_setting()`, `SCF::get_loop()` для Repeater
   - Проверять существование: `if(SCF::get('field_name'))`

3. **Цикл WordPress:**
   - Использовать стандартный Loop: `if (have_posts()) : while (have_posts()) : the_post();`
   - Или `WP_Query` для кастомных запросов
   - Всегда сбрасывать: `wp_reset_postdata()`

4. **Изображения:**
   - Использовать `wp_get_attachment_image()` или SCF функции
   - Добавлять размеры изображений через `add_image_size()`
   - Использовать `get_the_post_thumbnail()` для миниатюр

---

## Интеграция с существующей сборкой

### Работа с Vite и CSS:

1. **Сборка стилей и скриптов:**
   - Проект использует обычный CSS (файл `main.css`), а не Sass
   - CSS файл находится в `assets/css/main.css`
   - Vite может использоваться для минификации и оптимизации
   - В WordPress подключать файлы через `wp_enqueue_*`

2. **Структура исходников:**
   ```
   src/
   ├── css/
   │   └── main.css (основной файл стилей)
   └── js/
       ├── main.js
       └── modules/
   ```

3. **Build процесс:**
   - Vite обрабатывает и минифицирует CSS/JS
   - Результат сохраняется в `assets/css/` и `assets/js/`
   - После сборки файлы доступны в WordPress теме
   - Настроить пути в `vite.config.js` под структуру темы

---

## Доступность и SEO

1. **Использовать WordPress функции SEO:**
   - `wp_head()` для meta тегов
   - Поддержка плагинов SEO (Yoast, Rank Math)
   - Правильная структура заголовков (h1-h6)

2. **Доступность:**
   - Семантический HTML5
   - ARIA атрибуты где необходимо
   - Правильная структура навигации

---

## Производительность

1. **Оптимизация:**
   - Ленивая загрузка изображений (`loading="lazy"`)
   - Минификация CSS/JS через Vite
   - Использование `wp_enqueue_script(..., array(), 'version', true)` для defer
   - Кэширование через плагины WordPress

2. **Базы данных:**
   - Использовать `WP_Query` эффективно
   - Избегать N+1 запросов
   - Использовать `wp_cache` где возможно

---

## Тестирование

1. **Проверять:**
   - Работу всех SCF полей
   - Корректность отображения при изменении контента
   - Отзывчивость на разных устройствах
   - Совместимость с последними версиями WordPress

2. **Обязательные проверки:**
   - Изменение текстов через админку → отображаются на сайте
   - Добавление фотографии в портфолио → появляется на сайте
   - Изменение контактов → обновляются везде
   - Добавление отзыва → появляется в секции отзывов

---

## Документирование

1. **Для администратора:**
   - Создавать инструкции по работе с SCF полями
   - Описывать структуру управления контентом
   - Указывать какие поля обязательны

2. **В коде:**
   - Комментировать сложные участки
   - Указывать назначение кастомных функций
   - Документировать хуки и фильтры

---

## Важно

- **Никогда не хардкодить контент** который должен изменяться
- **Всегда проверять существование данных** перед выводом
- **Использовать стандартные WordPress практики** для совместимости
- **Тестировать изменения контента** через админ панель
- **Обеспечивать обратную совместимость** при обновлениях
- **Проект использует обычный CSS**, не Sass - учитывать это при работе со стилями
