---
rule_type: always
description: WordPress theme structure and file organization rules for portfolio theme
---

# WordPress Theme Structure Rules

## Структура темы

### Обязательная структура файлов WordPress темы:

```
ekaterina-portfolio-theme/
├── style.css (заголовок темы)
├── functions.php (инициализация, хуки, регистрация)
├── index.php (fallback шаблон)
├── header.php (шапка сайта)
├── footer.php (подвал сайта)
│
├── page.php (шаблон страницы)
├── single.php (шаблон записи)
├── archive.php (архив записей)
├── 404.php (страница 404)
├── search.php (результаты поиска)
│
├── template-parts/ (переиспользуемые части)
│   ├── content/
│   │   ├── content-none.php
│   │   ├── content-page.php
│   │   └── content-single.php
│   ├── components/
│   │   ├── hero-section.php
│   │   ├── introduction-section.php
│   │   ├── stats-banner.php
│   │   ├── philosophy-section.php
│   │   ├── about-section.php
│   │   ├── portfolio-section.php
│   │   ├── expertise-section.php
│   │   ├── services-section.php
│   │   ├── process-section.php
│   │   ├── testimonials-section.php
│   │   ├── recognition-section.php
│   │   └── contact-section.php
│   └── sections/
│       ├── header-nav.php
│       └── footer-widgets.php
│
├── templates/ (кастомные шаблоны страниц)
│   ├── template-homepage.php
│   └── template-contacts.php
│
├── assets/ (компилированные ресурсы из Vite)
│   ├── css/
│   │   └── main.css (основной файл стилей)
│   ├── js/
│   │   └── main.js
│   ├── images/
│   └── fonts/
│
├── src/ (исходные файлы для сборки)
│   ├── css/
│   │   └── main.css (основной CSS файл)
│   └── js/
│       ├── main.js
│       └── modules/
│
├── inc/ (вспомогательные PHP файлы)
│   ├── theme-setup.php (настройка темы)
│   ├── enqueue-assets.php (подключение ресурсов)
│   ├── custom-post-types.php (кастомные типы записей)
│   ├── scf-fields.php (настройка SCF)
│   ├── theme-functions.php (кастомные функции)
│   └── security.php (функции безопасности)
│
└── languages/ (переводы, если нужны)
    └── ekaterina-portfolio.pot
```

---

## Ключевые файлы

### style.css

**Обязательный заголовок темы:**
```css
/*
Theme Name: Ekaterina Portfolio
Theme URI: 
Author: Николай Д.
Author URI: https://develonik.ru
Description: Портфолио ведущей премиальных мероприятий Екатерины Шулятниковой. Кастомная WordPress тема с полным управлением контентом через SCF.
Version: 1.0.0
Requires at least: 6.0
Tested up to: 6.4
Requires PHP: 8.1
License: Proprietary
License URI: 
Text Domain: ekaterina-portfolio
*/
```

### functions.php

**Структура:**
```php
<?php
/**
 * Ekaterina Portfolio Theme Functions
 */

// Защита от прямого доступа
if (!defined('ABSPATH')) {
    exit;
}

// Константы темы
define('THEME_VERSION', '1.0.0');
define('THEME_PATH', get_template_directory());
define('THEME_URI', get_template_directory_uri());

// Подключение файлов инициализации
require_once THEME_PATH . '/inc/theme-setup.php';
require_once THEME_PATH . '/inc/enqueue-assets.php';
require_once THEME_PATH . '/inc/custom-post-types.php';
require_once THEME_PATH . '/inc/scf-fields.php';
require_once THEME_PATH . '/inc/theme-functions.php';
```

---

## Правила организации файлов

### 1. Разделение ответственности

**inc/theme-setup.php:**
- Регистрация поддержки функций темы
- Регистрация меню
- Регистрация сайдбаров (если нужны)
- Добавление хуков настройки

**inc/enqueue-assets.php:**
- Все `wp_enqueue_style()`
- Все `wp_enqueue_script()`
- Условная загрузка ресурсов
- Оптимизация загрузки

**inc/custom-post-types.php:**
- Регистрация Custom Post Types (portfolio_items, testimonials)
- Регистрация таксономий
- Мета-боксы (если не используется SCF)

**inc/scf-fields.php:**
- Регистрация групп SCF полей
- Локализация SCF (если нужно)
- Поля опций (Options Page)

**inc/theme-functions.php:**
- Кастомные функции темы
- Хуки и фильтры
- Вспомогательные функции

### 2. Template Parts

**Использование:**
- Для переиспользуемых компонентов
- Для логической группировки кода
- Для упрощения поддержки

**Пример:**
```php
// В шаблоне страницы
<?php get_template_part('template-parts/components/hero-section'); ?>
<?php get_template_part('template-parts/components/introduction-section'); ?>
<?php get_template_part('template-parts/components/portfolio-section'); ?>
```

**Параметры:**
```php
// Передача данных
<?php 
$args = array(
    'title' => SCF::get('hero_title'),
    'subtitle' => SCF::get('hero_subtitle')
);
get_template_part('template-parts/components/hero-section', null, $args);
?>
```

### 3. Кастомные шаблоны страниц

**Создание:**
- В начале файла: `<?php /* Template Name: Homepage */ ?>`
- Использовать для уникальных страниц
- Настраивать в админке: Страницы → Атрибуты страницы

**Примеры:**
- `template-homepage.php` - Главная страница портфолио
- `template-contacts.php` - Страница контактов (если нужна отдельная)

---

## Интеграция с Vite

### Структура сборки

**Исходники (src/):**
```
src/
├── css/
│   └── main.css (основной CSS файл)
└── js/
    └── main.js
```

**Результат сборки (assets/):**
```
assets/
├── css/
│   └── main.css (минифицированный CSS)
└── js/
    └── main.js (минифицированный JavaScript)
```

### Настройка Vite для темы

**vite.config.js должен:**
1. Обрабатывать CSS (минификация)
2. Обрабатывать JavaScript
3. Выводить файлы в `assets/`
4. Минифицировать в production
5. Генерировать source maps (опционально)

### Подключение в WordPress

**В inc/enqueue-assets.php:**
```php
// Стили
wp_enqueue_style(
    'ekaterina-portfolio-style',
    THEME_URI . '/assets/css/main.css',
    array(),
    THEME_VERSION
);

// Скрипты
wp_enqueue_script(
    'ekaterina-portfolio-script',
    THEME_URI . '/assets/js/main.js',
    array(), // зависимости
    THEME_VERSION,
    true // в footer
);
```

---

## Правила именования

### Файлы PHP

- **Шаблоны:** `template-{name}.php`
- **Template parts:** `{component-name}.php`
- **Функции:** `{theme-name}-{function-name}.php` или `{function-name}.php`

### Классы CSS

- Использовать BEM методологию или похожую
- Префикс темы: `.ep-` (Ekaterina Portfolio)
- Пример: `.ep-hero`, `.ep-hero__title`, `.ep-hero--fullscreen`

### JavaScript функции

- Префикс темы: `ep_` или `ekaterinaPortfolio`
- Пример: `ep_initNavigation()`, `ekaterinaPortfolio.showModal()`

### PHP функции

- Префикс темы: `ekaterina_portfolio_` или `ep_`
- Пример: `ekaterina_portfolio_get_testimonial()`, `ep_render_component()`

---

## Организация стилей

### Структура CSS

**Проект использует обычный CSS (не Sass):**

```
src/css/
└── main.css (основной файл стилей)
```

**Организация внутри main.css:**
```css
/* ========================================
   Reset & Base Styles
   ======================================== */

/* ========================================
   Typography
   ======================================== */

/* ========================================
   Header Styles
   ======================================== */

/* ========================================
   Hero Section
   ======================================== */

/* ========================================
   Introduction Section
   ======================================== */

/* ========================================
   Portfolio Section
   ======================================== */

/* ========================================
   Services Section
   ======================================== */

/* ========================================
   Testimonials Section
   ======================================== */

/* ========================================
   Contact Section
   ======================================== */

/* ========================================
   Footer
   ======================================== */

/* ========================================
   Utilities & Helpers
   ======================================== */
```

**Примечание:** Весь CSS находится в одном файле `main.css` для упрощения структуры. При необходимости можно разделить на модули, но это не обязательно.

---

## Организация JavaScript

### Модульная структура

```
src/js/
├── main.js (главный файл)
└── modules/
    ├── navigation.js
    ├── animations.js
    ├── portfolio.js
    ├── forms.js
    └── scroll-effects.js
```

### Пример модуля

```javascript
// modules/navigation.js
export function initNavigation() {
    // Логика навигации
    const header = document.getElementById('header');
    // ...
}

// main.js
import { initNavigation } from './modules/navigation.js';

document.addEventListener('DOMContentLoaded', () => {
    initNavigation();
});
```

---

## Важные правила

### 1. Всегда использовать get_template_directory()

**Правильно:**
```php
require_once get_template_directory() . '/inc/theme-setup.php';
```

**Неправильно:**
```php
require_once '/inc/theme-setup.php'; // Абсолютный путь
```

### 2. Использовать константы темы

```php
define('THEME_URI', get_template_directory_uri());
define('THEME_PATH', get_template_directory());
```

### 3. Проверка существования файлов

```php
$file_path = THEME_PATH . '/inc/file.php';
if (file_exists($file_path)) {
    require_once $file_path;
}
```

### 4. Защита от прямого доступа

**В каждом PHP файле (кроме index.php):**
```php
if (!defined('ABSPATH')) {
    exit;
}
```

---

## Контрольный список структуры

При создании темы проверить:

- [ ] Создан style.css с правильным заголовком
- [ ] Создан functions.php с подключением всех файлов
- [ ] Созданы header.php и footer.php
- [ ] Создан index.php как fallback
- [ ] Созданы шаблоны страниц (page.php, single.php)
- [ ] Организованы template-parts для всех секций портфолио
- [ ] Создана папка inc/ с разделением по файлам
- [ ] Настроена интеграция с Vite
- [ ] Все пути используют WordPress функции
- [ ] Все файлы защищены от прямого доступа
- [ ] CSS файл main.css организован с комментариями

---

## Миграция существующего кода

### Процесс:

1. **Создать структуру темы**
   - Базовые файлы WordPress
   - Папки для организации
   - Template parts для каждой секции

2. **Перенести HTML в шаблоны**
   - Разбить index.html на header.php, footer.php, template parts
   - Адаптировать под WordPress структуру
   - Сохранить все секции: Hero, Introduction, Portfolio, Services, Testimonials, Contact

3. **Интегрировать контент**
   - Заменить статический контент на SCF поля
   - Использовать WordPress функции для вывода
   - Сохранить структуру и стили из main.css

4. **Настроить сборку**
   - Адаптировать Vite под структуру темы
   - Настроить пути для компиляции CSS и JS
   - Убедиться, что main.css обрабатывается корректно

5. **Тестирование**
   - Проверить работу всех шаблонов
   - Проверить управление контентом через SCF
   - Проверить производительность
   - Проверить адаптивность

---

## Особенности проекта

- **CSS:** Проект использует обычный CSS (main.css), не Sass/SCSS
- **Структура:** Один основной CSS файл для упрощения
- **Компоненты:** Каждая секция портфолио - отдельный template part
- **SCF:** Все динамические данные через Secure Custom Fields
