---
rule_type: always
description: Development workflow and best practices for this project
---

# Development Workflow

## Процесс разработки

### 1. Планирование

**Перед началом работы:**
- [ ] Изучить задачу полностью
- [ ] Определить какие данные будут управляться через CMS
- [ ] Спланировать структуру SCF полей
- [ ] Определить необходимые шаблоны
- [ ] Представить план пользователю для подтверждения

### 2. Разработка

**Этапы создания компонента:**

1. **Создать SCF поля** (если нужны)
   - Определить структуру данных
   - Настроить поля в SCF
   - Заполнить тестовыми данными

2. **Создать шаблон/компонент**
   - Структура HTML
   - Подключение SCF данных
   - Экранирование всех данных

3. **Стилизация**
   - CSS файлы (обычный CSS, не Sass)
   - Адаптивность
   - Анимации (если нужны)

4. **JavaScript (если нужен)**
   - Модульная структура
   - Обработка событий
   - Интеграция с WordPress

5. **Тестирование**
   - Проверка работы в админке
   - Изменение данных через CMS
   - Проверка отображения
   - Адаптивность

### 3. Проверка качества

**Перед завершением:**
- [ ] Код следует стандартам WordPress
- [ ] Все данные проверяются и экранируются
- [ ] Нет ошибок в консоли браузера
- [ ] Работает на разных устройствах
- [ ] Производительность в норме
- [ ] Контент управляется через CMS

---

## Работа с WordPress

### Порядок создания страницы

1. **Определить тип страницы:**
   - Обычная страница (page.php)
   - Кастомный шаблон (template-{name}.php)
   - Custom Post Type archive

2. **Создать SCF поля:**
   - Для конкретной страницы
   - Или в Options (если глобальные)

3. **Создать/обновить шаблон:**
   - Использовать template parts
   - Подключить SCF данные
   - Проверить существование данных

4. **Стилизация:**
   - Обновить CSS файл (main.css)
   - Проверить адаптивность

5. **Тестирование:**
   - Изменить данные в админке
   - Проверить отображение
   - Проверить все состояния

---

## Работа с контентом

### Принцип: Контент в CMS

**Всегда задавать вопросы:**
- Может ли это измениться? → В SCF
- Нужно ли администратору менять? → В SCF
- Это бизнес-логика или дизайн? → Бизнес-логика в SCF

**Примеры:**

**✅ Правильно:**
- Портфолио → SCF Repeater
- Контакты → SCF Options
- Описания → SCF WYSIWYG
- Фотографии → SCF Image/Gallery

**❌ Неправильно:**
- Цены захардкожены в HTML
- Контакты в коде
- Описания в шаблонах
- Пути к изображениям статичные

---

## Коммиты и изменения

### Структура коммита

**Формат:**
```
[Тип] Краткое описание

Подробное описание (если нужно)
- Что изменено
- Почему изменено
- Что протестировано
```

**Типы:**
- `[Feature]` - Новая функциональность
- `[Fix]` - Исправление бага
- `[Refactor]` - Рефакторинг кода
- `[Style]` - Изменения стилей
- `[Docs]` - Документация
- `[WordPress]` - Интеграция WordPress
- `[SCF]` - Настройка SCF полей

**Примеры:**
```
[Feature] Добавлена секция портфолио с SCF полями

- Создан template-part для портфолио
- Настроены SCF поля для работ
- Реализован вывод галереи портфолио
- Проверено добавление работ через админку
```

---

## Тестирование

### Чеклист перед завершением задачи

**Функциональность:**
- [ ] Все функции работают как задумано
- [ ] Контент выводится корректно
- [ ] Формы отправляются (если есть)
- [ ] Модальные окна работают (если есть)

**WordPress интеграция:**
- [ ] Контент изменяется через админку
- [ ] SCF поля сохраняются и выводятся
- [ ] Нет PHP ошибок
- [ ] Нет предупреждений в дебаге

**Безопасность:**
- [ ] Все данные экранированы
- [ ] Формы защищены nonce
- [ ] Нет SQL инъекций
- [ ] Нет XSS уязвимостей

**Производительность:**
- [ ] Нет лишних запросов к БД
- [ ] Изображения оптимизированы
- [ ] CSS/JS минифицированы
- [ ] Скорость загрузки нормальная

**Адаптивность:**
- [ ] Мобильная версия работает
- [ ] Планшетная версия работает
- [ ] Десктопная версия работает
- [ ] Все элементы кликабельны

**Доступность:**
- [ ] Семантический HTML
- [ ] Alt текст для изображений
- [ ] Контрастность текста
- [ ] Навигация с клавиатуры

---

## Работа с SCF

### Процесс создания полей

1. **Планирование:**
   - Определить структуру данных
   - Выбрать типы полей
   - Решить группировку

2. **Создание в админке:**
   - Создать группу полей
   - Настроить правила размещения
   - Добавить поля

3. **Использование в коде:**
   - Проверить существование: `if( SCF::get('field_name') )`
   - Получить данные: `SCF::get('field_name')`
   - Для опций: `SCF::get_option_meta('option_name', 'field_name')`
   - Экранировать: `esc_html( SCF::get('field_name') )`

4. **Документирование:**
   - Указать назначение группы
   - Описать обязательные поля
   - Привести примеры использования

---

## Оптимизация

### Проверка производительности

**Регулярно проверять:**
- Размер CSS/JS файлов
- Количество HTTP запросов
- Время загрузки страницы
- Использование памяти PHP

**Инструменты:**
- Lighthouse (Chrome DevTools)
- GTmetrix
- WordPress Debug Bar
- Query Monitor (плагин)

**Цели:**
- Первая отрисовка < 1.5s
- Time to Interactive < 3s
- Lighthouse Score > 90
- Размер страницы < 2MB

---

## Работа с Git

### Правила работы с репозиторием

1. **Ветки:**
   - `main` - продакшн версия
   - `develop` - разработка
   - `feature/{название}` - новая функциональность

2. **Коммиты:**
   - Частые и осмысленные
   - Один коммит = одна логическая задача
   - Понятные сообщения

3. **Перед пушем:**
   - Проверить что все работает
   - Нет ошибок линтера
   - Коммиты логичны

4. **Обязательный пуш после изменений:**
   - **ВСЕГДА** пушить изменения в репозиторий после внесения любых изменений в код
   - После каждого коммита выполнять `git push`
   - Не оставлять незапушенные изменения
   - Это правило применяется ко всем изменениям без исключений

---

## Документация

### Что документировать

1. **SCF поля:**
   - Назначение
   - Структура
   - Примеры значений

2. **Кастомные функции:**
   - Параметры
   - Возвращаемое значение
   - Пример использования

3. **Шаблоны:**
   - Когда используются
   - Какие поля нужны
   - Примеры использования

4. **Изменения:**
   - Что изменилось
   - Почему
   - Как мигрировать

---

## Важные напоминания

- **Всегда проверять существование данных** перед использованием
- **Всегда экранировать данные** перед выводом
- **Тестировать изменения контента** через админку
- **Документировать сложные решения**
- **Следовать WordPress стандартам**
- **Приоритет надежности** над скоростью разработки
