# Инструкция по деплою на хостинг Beget

Данная инструкция описывает процесс деплоя универсальной темы Portfolio на хостинг Beget.

## Особенности Beget

- Панель управления Beget (не cPanel)
- Автоматическая установка WordPress через панель
- Структура файлов: `/home/u/username/your-domain.ru/public_html/wp-content/themes/`
- SSH доступ может требовать активации в панели
- FTP/SFTP доступ для загрузки файлов
- Ограничения на права доступа к файлам (обычно 644 для файлов, 755 для директорий)

## Подготовка к деплою

### 1. Получение доступа

1. Войдите в панель управления Beget
2. Получите данные для FTP/SFTP:
   - **Файлы → FTP-доступ**
   - Запишите: хост, логин, пароль, порт

### 2. Сборка темы

На локальной машине выполните:

```bash
npm run build:theme
```

### 3. Подготовка архива (опционально)

Для удобства можно создать ZIP-архив темы:

```bash
cd portfolio-theme
zip -r ../portfolio-theme.zip .
cd ..
```

## Методы деплоя на Beget

### Метод 1: FTP/SFTP загрузка (рекомендуемый)

1. **Подключение через FTP-клиент:**
   - Используйте FileZilla, WinSCP или другой FTP-клиент
   - Хост: данные из панели Beget
   - Порт: обычно 21 (FTP) или 22 (SFTP)
   - Логин и пароль: из панели Beget

2. **Загрузка темы:**
   - Перейдите в `/public_html/wp-content/themes/`
   - Загрузите папку `portfolio-theme/`
   - Дождитесь завершения загрузки

3. **Установка прав доступа:**
   - Файлы: 644
   - Директории: 755
   - В FileZilla: правый клик → Права доступа к файлу

### Метод 2: File Manager в панели Beget

1. Войдите в панель управления Beget
2. Откройте **Файлы → Файловый менеджер**
3. Перейдите в `/public_html/wp-content/themes/`
4. Нажмите "Загрузить файлы"
5. Выберите ZIP-архив темы
6. После загрузки распакуйте архив
7. Установите права доступа через файловый менеджер

### Метод 3: SSH деплой (если доступен)

1. **Активация SSH:**
   - В панели Beget: **SSH → Включить SSH**
   - Запишите данные для подключения

2. **Подключение:**
   ```bash
   ssh username@your-domain.ru
   ```

3. **Копирование файлов:**
   ```bash
   # Используя scp с локальной машины
   scp -r portfolio-theme/ username@your-domain.ru:/home/u/username/your-domain.ru/public_html/wp-content/themes/
   
   # Или используя rsync
   rsync -avz portfolio-theme/ username@your-domain.ru:/home/u/username/your-domain.ru/public_html/wp-content/themes/portfolio-theme/
   ```

4. **Установка прав:**
   ```bash
   cd /home/u/username/your-domain.ru/public_html/wp-content/themes/portfolio-theme
   find . -type f -exec chmod 644 {} \;
   find . -type d -exec chmod 755 {} \;
   ```

## Настройка на сервере Beget

### 1. Активация темы

1. Войдите в админ-панель WordPress: `https://your-domain.ru/wp-admin`
2. **Внешний вид → Темы**
3. Найдите тему "Портфолио"
4. Нажмите "Активировать"

### 2. Установка плагина SCF

1. **Плагины → Добавить новый**
2. Найдите "Secure Custom Fields"
3. Установите и активируйте

### 3. Настройка главной страницы

1. Создайте страницу "Главная"
2. Выберите шаблон "Homepage"
3. **Настройки → Чтение → Главная страница** → выберите "Статическая страница"
4. Выберите страницу "Главная"

### 4. Заполнение SCF полей

Следуйте инструкциям в `MIGRATION_GUIDE.md`

## Проверка после деплоя

### Чек-лист проверки:

- [ ] Тема видна в админ-панели WordPress
- [ ] Тема активирована без ошибок
- [ ] Все файлы загружены (проверьте через File Manager)
- [ ] Права доступа установлены корректно (644/755)
- [ ] CSS и JS файлы загружаются (DevTools → Network)
- [ ] Изображения отображаются
- [ ] Формы работают (проверьте отправку)
- [ ] SCF плагин установлен и активирован
- [ ] SCF поля отображаются в админ-панели
- [ ] Сайт отображается корректно на вашем домене

## Проверка настроек Beget

### Версия PHP

1. В панели Beget: **PHP → Версия PHP**
2. Убедитесь, что выбрана версия 8.1 или выше

### Лимиты памяти

1. В панели Beget: **PHP → Настройки PHP**
2. Установите `memory_limit` на 256M или выше

### Проверка работы wp_mail()

1. Установите плагин для тестирования email (например, "Check Email")
2. Проверьте отправку тестового письма
3. Если не работает, настройте SMTP через плагин (например, "WP Mail SMTP")

## Решение типичных проблем на Beget

### Проблема: Тема не видна в админ-панели

**Решение:**
- Проверьте, что все файлы загружены
- Проверьте права доступа (644/755)
- Проверьте наличие файла `style.css` с заголовком темы

### Проблема: Стили не загружаются

**Решение:**
- Убедитесь, что файлы собраны через `npm run build:theme`
- Проверьте пути в `inc/enqueue-assets.php`
- Очистите кеш WordPress (плагин или вручную)

### Проблема: Ошибки PHP

**Решение:**
- Проверьте версию PHP (должна быть 8.1+)
- Проверьте логи ошибок в панели Beget
- Убедитесь, что все расширения PHP включены

### Проблема: Формы не отправляются

**Решение:**
- Проверьте настройки `wp_mail()` в WordPress
- Установите SMTP плагин, если необходимо
- Проверьте логи ошибок

## Контакты поддержки Beget

- Техподдержка: https://beget.com/ru/support
- Телефон: указан в панели управления
- Email: support@beget.com

## Откат изменений

Если что-то пошло не так:

1. Деактивируйте тему в админ-панели WordPress
2. Активируйте стандартную тему WordPress
3. Удалите папку темы через File Manager или FTP
4. Проверьте работоспособность сайта
5. Повторите деплой после исправления проблем

## Обновление темы

При обновлении темы:

1. Соберите новую версию: `npm run build:theme`
2. Загрузите обновленные файлы через FTP/SFTP
3. Перезапишите старые файлы
4. Очистите кеш WordPress и браузера
5. Проверьте работоспособность

